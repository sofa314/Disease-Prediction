<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkup Selection</title>
    <link rel="icon" href="image/favicon/to-do-list.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/checkups.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body>
    <div class="checkup-container" id="checkup-container" style="position:relative;">
        <button type="button" class="checkup-btn" style="position:absolute; top:1.2rem; left:1.2rem; margin-bottom:0;" onclick="window.location.href='Login_page/dashboard.html'">Back</button>
        <div class="checkup-title">Choose Your Checkup</div>
        <div class="checkup-list">
            <div class="checkup-card" id="heart-card">
                <div class="checkup-icon icon-heart"><i class="fa-solid fa-heart-pulse"></i></div>
                <div class="checkup-name">Heart Checkup</div>
                <div class="checkup-desc">Assess your heart health with our quick and easy checkup.</div>
                <button class="checkup-btn" onclick="showForm('heart')">Start Checkup</button>
            </div>
            <div class="checkup-card" id="breast-card">
                <div class="checkup-icon icon-breast"><i class="fa-solid fa-ribbon"></i></div>
                <div class="checkup-name">Breast Checkup</div>
                <div class="checkup-desc">Early detection is key. Begin your health checkup now.</div>
                <button class="checkup-btn breast" onclick="showForm('breast')">Start Checkup</button>
            </div>
            <div class="checkup-card" id="skin-card">
                <div class="checkup-icon icon-skin"><i class="fa-solid fa-person"></i></div>
                <div class="checkup-name">Skin Checkup</div>
                <div class="checkup-desc">Monitor your skin for signs of cancer and other conditions.</div>
                <button class="checkup-btn skin" onclick="showForm('skin')">Start Checkup</button>
            </div>
        </div>
    </div>
    <!-- Fullscreen form overlays -->
    <div class="form-overlay" id="heart-overlay" style="display:none;">
        <form id="heart-form" class="container p-4">
            <button type="button" class="btn btn-secondary mb-4" onclick="hideForm()">Back</button>
            <div class="text-center mb-4">
                <div class="checkup-icon icon-heart"><i class="fa-solid fa-heart-pulse"></i></div>
                <h2 class="checkup-name">Heart Checkup</h2>
            </div>
            <div class="row mb-4">
                <div class="col-lg-4 mb-3">
                    <label for="heart-age" class="form-label">1. Age</label>
                    <input type="number" class="form-control" id="heart-age" name="age" required 
                        placeholder="Enter your Age" min="0" max="120">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="heart-sex" class="form-label">2. Sex</label>
                    <select class="form-select" id="heart-sex" name="sex" required>
                        <option value="">Select your gender</option>
                        <option value="1">Male</option>
                        <option value="0">Female</option>
                    </select>
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="heart-cp" class="form-label">3. Chest Pain Type</label>
                    <select class="form-select" id="heart-cp" name="cp" required>
                        <option value="">Select chest pain type</option>
                        <option value="1">Typical angina (chest pain related to heart)</option>
                        <option value="2">Atypical angina (non-heart-related chest pain)</option>
                        <option value="3">Non-anginal pain (non-cardiac origin)</option>
                        <option value="4">Asymptomatic (no symptoms)</option>
                    </select>
                </div>
            </div>
            <div class="row mb-4">
                <div class="col-lg-4 mb-3">
                    <label for="heart-trestbps" class="form-label">4. Resting Blood Pressure</label>
                    <input type="number" class="form-control" id="heart-trestbps" name="trestbps" min="0" max="250" required 
                        placeholder="Enter your resting blood pressure (mm Hg)">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="heart-restecg" class="form-label">5. Resting ECG</label>
                    <select class="form-select" id="heart-restecg" name="restecg" required>
                        <option value="">Select ECG result</option>
                        <option value="0">Normal</option>
                        <option value="1">Abnormal</option>
                        <option value="2">Hypertrophy</option>
                    </select>
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="heart-thalach" class="form-label">6. Maximum Heart Rate</label>
                    <input type="number" class="form-control" id="heart-thalach" name="thalach" min="0" max="250" required 
                        placeholder="Enter your maximum heart rate (bpm)">
                </div>
            </div>
            <div class="row mb-4">
                <div class="col-lg-4 mb-3">
                    <label for="heart-exang" class="form-label">7. Exercise Induced Angina</label>
                    <select class="form-select" id="heart-exang" name="exang" required>
                        <option value="">Select option</option>
                        <option value="1">Yes</option>
                        <option value="0">No</option>
                    </select>
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="heart-oldpeak" class="form-label">8. ST Depression</label>
                    <input type="number" class="form-control" id="heart-oldpeak" name="oldpeak" step="0.1" min="0" max="10" required 
                        placeholder="Enter ST depression value">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="heart-slope" class="form-label">9. Slope of ST Segment</label>
                    <select class="form-select" id="heart-slope" name="slope" required>
                        <option value="">Select slope</option>
                        <option value="1">Upsloping</option>
                        <option value="2">Flat</option>
                        <option value="3">Downsloping</option>
                    </select>
                </div>
            </div>
            <div class="row mb-4">
                <div class="col-lg-4 mb-3">
                    <label for="heart-ca" class="form-label">10. Number of Major Vessels</label>
                    <input type="number" class="form-control" id="heart-ca" name="ca" min="0" max="3" required 
                        placeholder="Enter number of major vessels">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="heart-thal" class="form-label">11. Thalassemia</label>
                    <select class="form-select" id="heart-thal" name="thal" required>
                        <option value="">Select thalassemia</option>
                        <option value="1">Normal</option>
                        <option value="2">Fixed defect</option>
                        <option value="3">Reversable defect</option>
                    </select>
                </div>
                <div class="col-lg-4 mb-3 d-flex justify-content-end">
                    <button type="submit" class="btn btn-primary btn-lg px-5">Submit</button>
                </div>
            </div>
            <div class="checkup-result heart-result" style="margin-top:1rem; color:#e36376; font-weight:600;font-size:36px;"></div>
        </form>
    </div>

    <!-- Breast Checkup -->
    <div class="form-overlay" id="breast-overlay" style="display:none;">
        <form id="breast-form" class="container p-4">
            <button type="button" class="btn btn-secondary mb-4" onclick="hideForm()">Back</button>
            <div class="text-center mb-4">
                <div class="checkup-icon icon-breast"><i class="fa-solid fa-ribbon"></i></div>
                <h2 class="checkup-name">Breast Checkup</h2>
            </div>
            <div class="row mb-4">
                <div class="col-lg-4 mb-3">
                    <label for="breast-clump" class="form-label">1. Clump Thickness</label>
                    <input type="number" class="form-control" id="breast-clump" name="clump_thickness" min="1" max="10" required 
                           placeholder="Clump Thickness (1-10, cell density)">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="breast-cellsize" class="form-label">2. Uniformity of Cell Size</label>
                    <input type="number" class="form-control" id="breast-cellsize" name="uniformity_cell_size" min="1" max="10" required 
                           placeholder="Cell Size Uniformity (1-10)">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="breast-cellshape" class="form-label">3. Uniformity of Cell Shape</label>
                    <input type="number" class="form-control" id="breast-cellshape" name="uniformity_cell_shape" min="1" max="10" required 
                           placeholder="Cell Shape Uniformity (1-10)">
                </div>
            </div>
            <div class="row mb-4">
                <div class="col-lg-4 mb-3">
                    <label for="breast-adhesion" class="form-label">4. Marginal Adhesion</label>
                    <input type="number" class="form-control" id="breast-adhesion" name="marginal_adhesion" min="1" max="10" required 
                           placeholder="Marginal Adhesion (1-10)">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="breast-epithelial" class="form-label">5. Single Epithelial Cell Size</label>
                    <input type="number" class="form-control" id="breast-epithelial" name="single_epithelial_cell_size" min="1" max="10" required 
                           placeholder="Epithelial Cell Size (1-10)">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="breast-nuclei" class="form-label">6. Bare Nuclei</label>
                    <input type="number" class="form-control" id="breast-nuclei" name="bare_nuclei" min="1" max="10" required 
                           placeholder="Bare Nuclei (1-10)">
                </div>
            </div>
            <div class="row mb-4">
                <div class="col-lg-4 mb-3">
                    <label for="breast-chromatin" class="form-label">7. Bland Chromatin</label>
                    <input type="number" class="form-control" id="breast-chromatin" name="bland_chromatin" min="1" max="10" required 
                           placeholder="Bland Chromatin (1-10)">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="breast-nucleoli" class="form-label">8. Normal Nucleoli</label>
                    <input type="number" class="form-control" id="breast-nucleoli" name="normal_nucleoli" min="1" max="10" required 
                           placeholder="Normal Nucleoli (1-10)">
                </div>
                <div class="col-lg-4 mb-3">
                    <label for="breast-mitoses" class="form-label">9. Mitoses</label>
                    <input type="number" class="form-control" id="breast-mitoses" name="mitoses" min="1" max="10" required 
                           placeholder="Mitoses (1-10, cell division)">
                </div>
            </div>
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary btn-lg px-5">Submit</button>
            </div>
            <div class="checkup-result breast-result mt-4 text-center" style="color:#ff96a7; font-weight:600;font-size:36px;"></div>
        </form>
    </div>

    <!-- Skin Checkup -->
    <div class="form-overlay" id="skin-overlay" style="display:none;">
        <form id="skin-form" class="container p-4">
            <button type="button" class="btn btn-secondary mb-4" onclick="hideForm()">Back</button>
            <div class="text-center mb-4">
                <div class="checkup-icon icon-skin"><i class="fa-solid fa-person"></i></div>
                <h2 class="checkup-name">Skin Checkup</h2>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="form-group">
                        <label for="skin-image" class="form-label">Upload a photo of skin area</label>
                        <div class="custom-file-upload" onclick="document.getElementById('skin-image').click()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Click to upload</span>
                        </div>
                        <input id="skin-image" type="file" name="image" accept="image/*" required>
                        <div class="image-preview mt-3" id="skin-image-preview"></div>
                    </div>
                </div>
            </div>
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary btn-lg px-5">Submit</button>
            </div>
            <div class="checkup-result skin-result mt-4 text-center" style="color:#4db6ac; font-weight:600;font-size:36px;"></div>
        </form>
    </div>


<script src="https://www.gstatic.com/firebasejs/9.x.x/firebase-auth-compat.js"></script>
<script>

    function showForm(type) {
        // Hide main selection
        document.getElementById('checkup-container').style.display = 'none';
        // Show selected form
        document.getElementById(type + '-overlay').style.display = 'flex';
    }

    function hideForm() {
        // Show main selection
        document.getElementById('checkup-container').style.display = 'flex';
        // Hide all forms
        document.querySelectorAll('.form-overlay').forEach(overlay => {
            overlay.style.display = 'none';
        });
        // Clear results
        document.querySelectorAll('.checkup-result').forEach(result => {
            result.textContent = '';
        });
    }

    async function submitHeartForm(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const data = {};
        formData.forEach((value, key) => {
            data[key] = parseFloat(value);
        });

        try {
            const response = await fetch('http://localhost:5500/predict-heart', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ features: Object.values(data) })
            });
            
            const result = await response.json();
            if (result.error) {
                document.querySelector('.heart-result').textContent = `Error: ${result.message}`;
            } else {
                document.querySelector('.heart-result').textContent = 
                    result.prediction === 1 ? 
                    'High risk of heart disease' : 
                    'Low risk of heart disease';
            }
        } catch (error) {
            document.querySelector('.heart-result').textContent = 'Error: Could not connect to server';
        }
    }

    async function submitBreastForm(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const data = {};
        formData.forEach((value, key) => {
            data[key] = parseInt(value);
        });

        try {
            const response = await fetch('http://localhost:5500/predict-breast', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });
            
            const result = await response.json();
            if (result.error) {
                document.querySelector('.breast-result').textContent = `Error: ${result.message}`;
            } else {
                document.querySelector('.breast-result').textContent = 
                    result.prediction === 'Malignant' ? 
                    'Malignant tumor detected' : 
                    'Benign tumor detected';
            }
        } catch (error) {
            document.querySelector('.breast-result').textContent = 'Error: Could not connect to server';
        }
    }

    async function submitSkinForm(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        
        try {
            const response = await fetch('http://localhost:5001/predict-skin', {
                method: 'POST',
                body: formData
            });
            
            const result = await response.json();
            if (result.error) {
                document.querySelector('.skin-result').textContent = `Error: ${result.message}`;
            } else {
                document.querySelector('.skin-result').textContent = 
                    `Predicted class: ${result.predicted_class}`;
            }
        } catch (error) {
            document.querySelector('.skin-result').textContent = 'Error: Could not connect to server';
        }
    }

    // Attach event listeners
    document.getElementById('heart-form').addEventListener('submit', submitHeartForm);
    document.getElementById('breast-form').addEventListener('submit', submitBreastForm);
    document.getElementById('skin-form').addEventListener('submit', submitSkinForm);
    </script>
</body>
</html>